@using Newtonsoft.Json;
@model List<rvFleet.Models.GetVehicleAnualCostsGraphData_Result>
@{ 
    var JsonData = JsonConvert.SerializeObject(Model);
}

<canvas id="canvas-pie-chart-anualCosts" class="m-auto" style="width: 100%; height: 100%"></canvas>

<script>
    var JsonArray = JSON.parse('@Html.Raw(JsonData)');
    var data = {
        datasets: [{
            data: [10, 20, 30]
        }],

        // These labels appear in the legend and in the tooltips when hovering different arcs
        labels: [
            'Red',
            'Yellow',
            'Blue'
        ]
    };

    function loadAnualCostsPie() {
        var graphData = [];
        var labels = [];
        var formatedNumber = [];
        var backgroundColors = [];

        $.each(JsonArray, function (index, item) {
            labels.push(item.NombreRubro);
            graphData.push(item.FacValorFactura);
            formatedNumber.push(item.FormatedNumber);
            backgroundColors.push(item.ColorIdentificador);
        });

        data.datasets[0] = {
            data: graphData,
            backgroundColor: backgroundColors,
            fnumber: formatedNumber
        };
        data.labels = labels;

        const config = {
            type: 'pie',
            data: data,
            options: {
                tooltips: {
                    callbacks: {
                        label: function (t, d) {
                            return `${d.labels[t.index]} ${d.datasets[0].fnumber[t.index]}`;
                        }
                    }
                }
            }
        };

        var ctx = $('#canvas-pie-chart-anualCosts');
        var myChart = new Chart(ctx, config);
    };
</script>
